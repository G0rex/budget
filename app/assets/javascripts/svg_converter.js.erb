$(document).bind('page:change', function(e) {

    d3.select("#save").on("click", function() {
        var svg = d3.select("#chart").node().innerHTML.split('</svg>')[0] + "</svg>";
        var html1 = svg.split("<desc");
        var html2 = html1[1].split("/defs>")[1];
        var html = html1[0] + html2;

        var canvas = document.querySelector("canvas");
        var context = canvas.getContext("2d");

        var img_png = new Image();
        img_png.src = 'data:image/svg+xml;base64,' + window.btoa(html);
        img_png.onload = img_load();
        function img_load() {

            context.drawImage(img_png, 0, 0);
            var canvasdata = canvas.toDataURL("image/png");

            var a = document.createElement("a");
            a.download = "sample.png";
            a.href = canvasdata;
            a.click();
        }
    })

})