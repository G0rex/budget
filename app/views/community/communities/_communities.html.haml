:css
  .coordinates {
    max-height: 200px;
    overflow-y: auto;
  }

  .editable-pre-wrapped {
    white-space: normal;
  }

  td.centered, th.centered {
    text-align: center;
  }

%table.table.table-striped
  %thead
    %tr
      %th.col-sm-2 Назва
      %th.col-sm-2 Посилання
      %th.col-sm-3 Склад
      %th.col-sm-1 Координати
      %th Геометричний тип
      %th.centered Узгоджено
      %th.centered Колір
      %th.centered Іконка
      %th Видалити
  %tbody
    - @community_communities.each do |community|
      %tr{'data-id' => community.id}
        %td
          %a{:href => '#', :class => 'editable', :id => 'title', 'data-resource' => 'community', 'data-type' => 'text', 'data-pk' => community.id, 'data-url' => community_community_path(community), 'data-emptytext' => 'Вкажіть назву громади...'}
            = community.title
        %td
          %a{:href => '#', :class => 'editable', :id => 'link', 'data-resource' => 'community', 'data-type' => 'text', 'data-pk' => community.id, 'data-url' => community_community_path(community), 'data-emptytext' => 'Вкажіть посилання...'}
            = community.link
        %td
          %a{:href => '#', :class => 'editable', :id => 'participants', 'data-resource' => 'community', 'data-type' => 'textarea', 'data-pk' => community.id, 'data-url' => community_community_path(community), 'data-emptytext' => 'Вкажіть склад громади...'}
            = community.participants
        %td
          .coordinates
            %a{:href => '#', :class => 'editable', :id => 'coordinates', 'data-resource' => 'community', 'data-type' => 'textarea', 'data-pk' => community.id, 'data-url' => community_community_path(community), 'data-emptytext' => 'Вкажіть координати...'}
              = community.coordinates
        %td
          %a{:href => '#', :class => 'editable', :id => 'geometry_type', 'data-resource' => 'community', 'data-type' => 'text', 'data-pk' => community.id, 'data-url' => community_community_path(community), 'data-emptytext' => 'Вкажіть геометричний тип...'}
            = community.geometry_type
        %td.centered
          %a.agree{:href => '#', :id => 'agree', 'data-resource' => 'community', 'data-pk' => community.id, 'data-url' => community_community_path(community), 'data-value' => community.agree ? 1 : 0}
        %td.centered
          %a.color{:href => '#', :id => 'color', 'data-resource' => 'community', 'data-type' => 'select2', 'data-pk' => community.id, 'data-url' => community_community_path(community), 'data-emptytext' => 'Вкажіть колір...', 'data-value' => community.color ? community.color : ""}
        %td.centered
          %a.icon{:href => '#', :id => 'icon', 'data-resource' => 'community', 'data-type' => 'select2', 'data-pk' => community.id, 'data-url' => community_community_path(community), 'data-emptytext' => 'Вкажіть іконку...', 'data-value' => community.icon ? community.icon : ""}
        %td
          = link_to community, :remote => true, :method => :delete, :data => { :confirm => 'Ви впевнені, що хочете видалити запис?' }, :class => '' do
            %i.fa.fa-times.pull-right

:javascript

  $(document).ready(function() {
    $('.editable').editable();

    $('.agree').editable({
      type: 'checklist',
      source: {'1': 'затверджено'},
      display: function(value, sourceData) {
        if(value[0] == "1") {
          value = 1;
        } else if(Array.isArray(value)){
          value = 0;
        }
        if(value) {
          $(this).html('<i class="fa fa-check-square-o"></i>');
        } else {
          $(this).html('<i class="fa fa-square-o"></i>');
        }
      },
      params: function (params) {
          if(params['value'].length == 0) {
            params['value'] = "0";
            $(this).html('<i class="fa fa-square-o"></i>');
          } else {
            params['value'] = "1";
          }
          return params;
      }
    });

    var icons = [], colors = [];

    /* Loading colors and icons once while loading the page.*/
    if(icons == "" || colors == "") {
      $.getJSON( "#{asset_path('enums.json') }", function( data ) {
        $.each( data['fa_icon_list'], function(key,val) {
          icons.push({id: val, text: val});
        })
        $.each( data['undp_colors_list'], function(key,val) {
          colors.push({id: val, text: val});
        })
      });
    }

    $('.color').editable({
      source: colors,
      select2: {
        width: '200px',
        allowClear: true,
        multiple: false,
        formatResult: formatColorSelect,
        formatSelection: formatColorSelect,
      },
      display: function(value, sourceData) {
        if(value) {
          $(this).html("<div style='width: 100%; height: 43px; background-color: " + value + "; border-radius: 10px;'/>");
        } else {
          $(this).html("<div style='width: 100%; height: 43px; background-color: #428bca; border-radius: 10px;'/>");
        }
      }
    });

    function formatColorSelect(el) {
      return "<div style='width: 100%; height: 43px; background-color: " + el.id + "'/>";
    }

    $('.icon').editable({
      source: icons,
      select2: {
        width: '200px',
        allowClear: true,
        multiple: false,
        formatResult: formatFaSelect,
        formatSelection: formatFaSelect,
      },
      display: function(value, sourceData) {
        if(value) {
          $(this).html("<i class='fa " + value + "'/>");
        } else {
          $(this).html("<i class='fa fa-users'/>");
        }
      }
    });

    function formatFaSelect(el) {
      return "<i class='fa " + el.id + "'/>" + el.id;
    }
  });