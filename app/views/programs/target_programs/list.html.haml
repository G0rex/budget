:css

  .datepicker-dropdown.dropdown-menu {
    background-color: #ffffff;
  }

= content_for :header do
  .head.pull-left
    = t('programs.target_programs.index.header') + @town.name

.col-sm-12{'style' => 'position: relative;'}
  .input-daterange.pull-left{'style' => 'margin-right: 10px;'}
    = t('programs.target_programs.list.data_header')
    %input{name: :term_end, :type => "text", :class => "year_datepicker form-control" }
  %span{'style' => 'position: absolute; bottom: 0px;'}
    %i{ :class => "fa fa-lg fa-square-o", :style => "color: #2C9911;" }
    = t('programs.target_programs.list.active_programs')
    %i{ :class => "fa fa-lg fa-check-square-o", :style => "color: #2C9911;" }
    = t('programs.target_programs.list.accomplished_programs')

#programs_list
  = render 'list', :programs => @programs_target_programs, :amounts => @amounts, :year => @year

= link_to t('form.explanation'), edit_programs_town_path(@town.id), :class => 'btn btn-primary'
= link_to t('form.back'), programs_towns_path, :class => 'btn btn-default'

:javascript

  $(document).ready(function() {

    // ------------------------ DATEPICKER -----------------------------
    $.fn.datepicker.dates[window.aHelper.lang()];
    $(".year_datepicker").datepicker( {
      format: 'dd.mm.yyyy',
      startView: 2,
      endDate: '+0y',
      multidate: true,
      language: window.aHelper.lang(),
      autoclose: true,
      minViewMode: 'years',
      viewMode: 'years',
      pickTime: false
    }).on('changeDate', function(){
        var year = $(this).val().split('.')[2];
        $.ajax({
          type: "GET",
          url: "/programs/target_programs/change_list/#{@town.id}/" + year
        });
    });

    var currYear = new Date().getFullYear();
    var startDate = new Date(currYear,0,1);
    $('.year_datepicker').datepicker('setDate', startDate);
  })