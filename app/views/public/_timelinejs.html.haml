= content_for :head do
  = javascript_include_tag '/assets/timelinejs/storyjs-embed.js'
  -#= javascript_include_tag "http://cdn.knightlab.com/libs/timeline/latest/js/storyjs-embed.js", 'onreadystatechange'=>"alert(1)"

#timeline-embed

:javascript
  $(document).on('ready page:load', function(){


    var deffered = function() {
      if (createStoryJS == undefined) {
        setTimeout(deffered, 500)
      } else {
        createStoryJS({
                        width:              '100%',
                        height:             '600',

                        source:             "#{public_timelinejs_path}.json?calendar_id=#{@calendar.id}",

                        embed_id:           'timeline-embed',               //OPTIONAL USE A DIFFERENT DIV ID FOR EMBED
                        start_at_end:       false,                          //OPTIONAL START AT LATEST DATE
                        start_at_slide:     "#{timeline_currentevent_num(@calendar.events)}",                            //OPTIONAL START AT SPECIFIC SLIDE
                        start_zoom_adjust:  '4',                            //OPTIONAL TWEAK THE DEFAULT ZOOM LEVEL
                        hash_bookmark:      true,                           //OPTIONAL LOCATION BAR HASHES
                        font:               'Bevan-PotanoSans',             //OPTIONAL FONT
                        debug:              false,                           //OPTIONAL DEBUG TO CONSOLE
                        lang:               'uk',                           //OPTIONAL LANGUAGE
                        maptype:            'watercolor',                   //OPTIONAL MAP STYLE
        })
      }
    }
    deffered()
  })