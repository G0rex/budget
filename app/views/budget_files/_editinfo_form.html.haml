= bootstrap_form_for @budget_file, :html => { 'accept-charset' => "UTF-8", :class => 'form-vertical' } do |f|
  = f.text_field :title, :label => t('budget_file_title')
  = f.select :data_type, [t('js.visify.plan'), t('js.visify.fact')], :label => t('budget_file_data_type')

  %hr
    %ul.nav.nav-tabs{role: 'tablist'}
      - @budget_file.taxonomy.columns.each do |key, val|
        %li
          %a{href: "#taxonnomy_#{val[:level]}", role: 'tab', 'data-toggle' => 'tab'}
            =val[:title]

    .tab-content
      - @budget_file.taxonomy.columns.each do |key, val|
        .tab-pane.fade.in{ :id => "taxonnomy_#{val[:level]}" }

          %table.table.table-striped.table-hover
            %tr
              %th{ :style => 'text-align: right'}
                =key
              %th
                = t('.name')
              %th
                = t('.icon')
              %th
                = t('.color')
              %th
                =t('.acceptors')
              %th
                = t('.description')

            - @budget_file.taxonomy.explanation[key].keys.sort_by { |item| item }.each do |t_key|
              %tr
                %td{style:'text-align: right'}
                  %h4=t_key
                %td
                  %input{name: "taxonomy[#{CGI.escape key}][#{CGI.escape t_key}][title]", value: @budget_file.taxonomy.explanation[key][t_key]['title'] }
                %td
                  -#= select_tag "taxonomy[#{CGI.escape key}][#{CGI.escape t_key}][icon]", options_for_select(fa_icon_list, @budget_file.taxonomy.explanation[key][t_key]['icon']), class: 'fa-select'
                  = select_tag "taxonomy[#{CGI.escape key}][#{CGI.escape t_key}][icon]", options_for_select([@budget_file.taxonomy.explanation[key][t_key]['icon']], @budget_file.taxonomy.explanation[key][t_key]['icon']), class: 'fa-select'
                %td
                  -#= select_tag "taxonomy[#{CGI.escape key}][#{CGI.escape t_key}][color]", options_for_select(undp_colors_list, @budget_file.taxonomy.explanation[key][t_key]['color']), class: 'color-select'
                  = select_tag "taxonomy[#{CGI.escape key}][#{CGI.escape t_key}][color]", options_for_select([@budget_file.taxonomy.explanation[key][t_key]['color']], @budget_file.taxonomy.explanation[key][t_key]['color']), class: 'color-select'
                %td
                  %input{name: "taxonomy[#{CGI.escape key}][#{CGI.escape t_key}][capita]", value: @budget_file.taxonomy.explanation[key][t_key]['capita'] }
                %td
                  %textarea{name: "taxonomy[#{CGI.escape key}][#{CGI.escape t_key}][description]", cols: 80, rows: 3}
                    = @budget_file.taxonomy.explanation[key][t_key]['description']

  %hr
  = f.submit t('budget_file_save'), :class => 'btn btn-primary'
  = link_to t('form.cancel', :default => t("helpers.links.cancel")), budget_files_path, :class => 'btn btn-default'

